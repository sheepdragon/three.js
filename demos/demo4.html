<!DOCTYPE html>
<html lang="en">
	<head>
		<title>demo</title>
		<meta charset="utf-8" />
		<meta
			name="viewport"
			content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
		/>
		<link type="text/css" rel="stylesheet" href="/examples/main.css" />
		<style>
			a {
				color: blue;
			}
			.control-inactive button {
				color: #888;
			}
		</style>
	</head>
	<body>
		<div id="container"></div>
		<!-- Import maps polyfill -->
		<!-- Remove this when import maps will be widely supported -->
		<script
			async
			src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"
		></script>

		<script type="importmap">
			{
				"imports": {
					"three": "../build/three.module.js",
					"three/addons/": "/examples/jsm/"
				}
			}
		</script>

		<script type="module">
			import * as THREE from "three";

			import Stats from "three/addons/libs/stats.module.js";
			import { GUI } from "three/addons/libs/lil-gui.module.min.js";
			import { OrbitControls } from "three/addons/controls/OrbitControls.js";
			import { GLTFLoader } from "three/addons/loaders/GLTFLoader.js";

			let scene, renderer, camera, stats, clock;
			let controls, mesh;

			const twoPi = Math.PI * 2;
			const aspect = window.innerWidth / window.innerHeight;

			init();
			animate();

			function init() {
				clock = new THREE.Clock();
				const container = document.getElementById("container");

				stats = new Stats();
				container.appendChild(stats.dom);

				// renderer
				renderer = new THREE.WebGLRenderer({ antialias: true });
				renderer.setPixelRatio(window.devicePixelRatio);
				renderer.setSize(window.innerWidth, window.innerHeight);
				renderer.shadowMap.enabled = true;
				container.appendChild(renderer.domElement);

				scene = new THREE.Scene();
				scene.background = new THREE.Color(0x444444);
				// scene.fog = new THREE.Fog(0xa0a0a0, 10, 50);
				scene.add(new THREE.AxesHelper(30));

				// camera
				camera = new THREE.PerspectiveCamera(40, aspect, 1, 1000);
				camera.position.set(15, 17, 40);
				window.camera = camera;

				// controls
				controls = new OrbitControls(camera, renderer.domElement);
				controls.target.set(0, 1, 0);
				controls.update();
				controls.enablePan = true;
				controls.enableZoom = true;
				controls.enableDamping = true;

				// 光源
				const lights = [];
				lights[0] = new THREE.PointLight(0xffffff, 1, 0);
				lights[1] = new THREE.PointLight(0xffffff, 1, 0);
				lights[2] = new THREE.PointLight(0xffffff, 1, 0);
				lights[0].position.set(0, 200, 0);
				lights[1].position.set(100, 200, 100);
				lights[2].position.set(-100, -200, -100);
				scene.add(lights[0]);
				scene.add(lights[1]);
				scene.add(lights[2]);

				//
				const group = new THREE.Group();
				const geometry = new THREE.ConeGeometry(5, 10, 3, 1, false, 0, twoPi);
				const material = new THREE.MeshPhongMaterial({
					color: 0x156289,
					emissive: 0x072534,
					side: THREE.DoubleSide,
					flatShading: true,
				});
				group.add(new THREE.Mesh(geometry, material))

				const lineMaterial = new THREE.LineBasicMaterial({ color: 0xffffff, transparent: true, opacity: 0.5 });
				group.add(new THREE.LineSegments(geometry, lineMaterial))

				group.position.y = 5;
				scene.add(group);

				window.geometry = geometry

				const points = [];
				points.push( new THREE.Vector3( 13, 0, 0 ) );
				points.push( new THREE.Vector3( 13, 13, 0 ) );
				const line = new THREE.Line( new THREE.BufferGeometry().setFromPoints( points ), new THREE.LineBasicMaterial({color: 0x0c0c0c}) );
				scene.add( line );
				window.line = line

				window.scene = scene
			}

			window.onresize = function onWindowResize() {
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
				renderer.setSize(window.innerWidth, window.innerHeight);
			};

			function animate() {
				requestAnimationFrame(animate);

				controls.update();
				stats.update();
				renderer.render(scene, camera);
			}
		</script>
	</body>
</html>
